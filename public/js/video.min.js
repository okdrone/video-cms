function question_dialog(){$("#question-confirm").dialog({resizable:!1,height:"auto",width:"9.0625rem",modal:!0,buttons:[{text:"马上开始",class:"open",click:function(){var e=$("#video_id").val();console.log(e),window.location="/video-cms/index.php?g=Video&m=Index&a=question&id="+e,$(this).dialog("close")}},{text:"稍后再说",class:"close",click:function(){$(this).dialog("close")}}]})}function complete_info(){$("#complete_info").dialog({resizable:!1,height:"auto",width:"9.0625rem",modal:!0,buttons:[{text:"确定",class:"ok",click:function(){if(!$("#agreement").is(":checked"))return alert("请先阅读并同意我们的服务协议"),!1;var e=$("#real_name").val(),i=$("#sex").val(),o=$("#age").val(),t=$("#phone").val();return""===e?(alert("请输入真实姓名"),!1):""===i?(alert("请输入性别"),!1):""===o?(alert("请输入年龄"),!1):""===t?(alert("请输入手机号码"),!1):($.getJSON("/video-cms/index.php?g=Video&m=Index&a=complete_info&"+$("#complete-form").serialize(),function(e,i){void 0!==e&&0===e.code&&$("#cu").val("")}),void $(this).dialog("close"))}}]})}function collect(e){$.get("/video-cms/index.php?g=Video&m=Collect&a=video&"+$.param(e),function(e){console.log(e)})}var videoDom=document.getElementById("J_prismPlayer");if(videoDom){var dpr=$("html").attr("data-dpr"),v_height="350px";void 0!==dpr&&dpr>2&&(v_height="525px");var player=new prismplayer({id:"J_prismPlayer",source:$("#video_link").val(),cover:$("#video_thumb").val(),autoplay:!1,trackLog:!1,playsinline:!0,width:"100%",height:v_height});player.on("play",function(){if(console.log("play"),"1"===$("#cu").val())player.pause(),complete_info();else{var e={};e.id=$("#video_id").val().trim(),e.action="play",e.time=player.getCurrentTime(),collect(e)}}),player.on("pause",function(){console.log("pause");var e=player.getCurrentTime(),i={};i.id=$("#video_id").val().trim(),i.action="pause",i.time=e,collect(i)}),player.on("ended",function(){question_dialog();var e=$("#test_btn"),i=$(e).find(".disable");$(i).hide();var o=$(e).find(".enable");$(o).show(),$(o).bind("click",question_dialog);var t={};t.id=$("#video_id").val().trim(),t.action="end",t.time=player.getCurrentTime(),collect(t)});var collectData={};collectData.id=$("#video_id").val().trim(),collectData.action="open",collect(collectData)}$("#title_btn").on("click",function(){$(this).hasClass("up")?($(this).removeClass("up"),$(this).addClass("down"),$("#title_desc").show("slow")):$(this).hasClass("down")&&($(this).removeClass("down"),$(this).addClass("up"),$("#title_desc").hide("slow"))});